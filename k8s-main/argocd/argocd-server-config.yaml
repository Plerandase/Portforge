apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-server-config
  namespace: default
  labels:
    app.kubernetes.io/name: argocd-server-config
    app.kubernetes.io/part-of: argocd
data:
  # ArgoCD 서버 설정
  url: https://argocd.portforge.org
  
  # OIDC 설정 (선택사항)
  oidc.config: |
    name: OIDC
    issuer: https://argocd.portforge.org/api/dex
    clientId: argo-cd
    clientSecret: $oidc.clientSecret
    requestedScopes: ["openid", "profile", "email", "groups"]
    requestedIDTokenClaims: {"groups": {"essential": true}}
  
  # 추가 설정
  application.instanceLabelKey: argocd.argoproj.io/instance
  server.rbac.log.enforce.enable: "false"
  exec.enabled: "false"
  server.enable.proxy.extension: "true"